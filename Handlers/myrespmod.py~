import sys
sys.path.append('../')
from icaprespmod import RespmodHandler

import json
from StringIO import StringIO
import gzip

class MyRespmod(RespmodHandler):
	def __init__(self, header, reader):
		RespmodHandler.__init__(self, header, reader)
	
	def modify(self):
		if 'ctype' in dir(self.respheader) and \
				self.respheader.ctype[:16] == 'application/json':

			self.respheader.cenc = 'deflate'

			root = json.loads(self.respbody.decode('ascii').encode('UTF-8'))
			root['Modifier'] = 'Garfield'

			self.respbody = json.dumps(root, sort_keys=True, indent=4)
